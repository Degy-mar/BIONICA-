<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Mapa curricular interactivo</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5f5f5;
    }
    .semestre {
      margin-bottom: 40px;
    }
    .semestre h2 {
      text-align: center;
      margin-bottom: 15px;
    }
    .materias {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      justify-content: center;
    }
    .materia {
      position: relative;
      width: 180px;
      padding: 12px;
      border-radius: 12px;
      background: white;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      cursor: pointer;
      transition: transform 0.2s;
    }
    .materia:hover {
      transform: scale(1.05);
    }
    .materia.seleccionada {
      border: 2px solid red;
    }
    .materia.cursada {
      background: #4caf50 !important;
      color: white;
      text-decoration: line-through;
    }
    .materia.bloqueada {
      opacity: 0.4;
      pointer-events: none;
    }
    .materia.disponible {
      border: 2px solid #4a90e2;
    }
    .creditos {
      font-size: 13px;
      color: gray;
    }
    .check-cursada {
      position: absolute;
      bottom: 6px;
      right: 8px;
      cursor: pointer;
      font-size: 14px;
      background: white;
      border: 1px solid #ccc;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      text-align: center;
      line-height: 18px;
    }
    .icon-doc {
      position: absolute;
      top: 6px;
      right: 8px;
      cursor: pointer;
      font-size: 16px;
    }
    /* Modal */
    .modal {
      display: none;
      position: fixed;
      top:0;left:0;width:100%;height:100%;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: white;
      padding: 20px;
      border-radius: 10px;
      max-width: 500px;
    }
    .close {
      float: right;
      cursor: pointer;
      font-weight: bold;
      font-size: 18px;
    }
  </style>
</head>
<body>

  <h1 style="text-align:center">Mapa Curricular</h1>
  <div id="contenedor"></div>

  <!-- Modal temario -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h3 id="modal-titulo"></h3>
      <ul id="modal-lista"></ul>
    </div>
  </div>

<script>
const materias = [
  { id:'calculo', nombre:'Cálculo Dif. e Integral', creditos:9, 
    temario:['Axiomas de los números reales y complejos, funciones y límites.','Cálculo Diferencial y sus aplicaciones.','Cálculo Integral y sus aplicaciones.','Sucesiones y Series.'], 
    semestre:1, deps:[], categoria:'matematicas' }, 
  { id:'algebra', nombre:'Álgebra Lineal', creditos:7.5, 
    temario:['Sistemas de ecuaciones lineales','Espacios vectoriales','Transformaciones lineales','Valores propios y vectores propios','Espacios con producto interior'], 
    semestre:1, deps:[], categoria:'matematicas' }, 
  { id:'biocel', nombre:'Biología Celular', creditos:7.5, 
    temario:['Fundamentos físicos y químicos.','Estructura celular.','Almacenamiento y expresión de la información genética.','Función celular.','Bases de fisiología y anatomía.'], 
    semestre:1, deps:[], categoria:'biologicas' }, 
  { id:'quimica', nombre:'Química Orgánica', creditos:7.5, 
    temario:['Introducción a la Química Orgánica.','Hidrocarburos.','Derivados de los hidrocarburos.','Carbohidratos.','Aminoácidos y proteínas'], 
    semestre:1, deps:[], categoria:'biologicas' },
  { id:'metrologia', nombre:'Metrología', creditos:6.5, 
    temario:['Generalidades.','Mediciones Eléctricas.','Mediciones Mecánicas.','Mediciones de Temperatura.'], 
    semestre:1, deps:[], categoria:'electronica' }, 
  { id:'bioetica', nombre:'Bioética', creditos:4.5, 
    temario:['Campo teórico de la bioética.','Dilemas bioéticos.','Bioética y medioambiente.','La cultura tecnocientífica.'], 
    semestre:1, deps:[], categoria:'sociales' }
];

// Recuperar materias cursadas del localStorage
let cursadas = JSON.parse(localStorage.getItem("cursadas")) || [];

// Render por semestre
const contenedor = document.getElementById("contenedor");
const semestres = [...new Set(materias.map(m=>m.semestre))];

semestres.forEach(num => {
  const divSem = document.createElement("div");
  divSem.className = "semestre";
  divSem.innerHTML = `<h2>Semestre ${num}</h2><div class="materias" id="sem-${num}"></div>`;
  contenedor.appendChild(divSem);

  materias.filter(m=>m.semestre===num).forEach(m=>{
    const div = document.createElement("div");
    div.className = "materia";
    div.dataset.id = m.id;
    div.innerHTML = `
      <strong>${m.nombre}</strong><br>
      <span class="creditos">${m.creditos} créditos</span>
      <div class="icon-doc">📄</div>
      <div class="check-cursada">✔</div>
    `;

    // Restaurar si ya estaba cursada
    if(cursadas.includes(m.id)) div.classList.add("cursada");

    div.querySelector(".icon-doc").addEventListener("click", (e)=>{
      e.stopPropagation();
      mostrarTemario(m);
    });
    div.addEventListener("click", ()=>{
      document.querySelectorAll(".materia").forEach(x=>x.classList.remove("seleccionada"));
      div.classList.add("seleccionada");
      m.deps.forEach(dep=>{
        const depDiv=document.querySelector(`.materia[data-id="${dep}"]`);
        if(depDiv) depDiv.classList.add("seleccionada");
      });
    });
    div.querySelector(".check-cursada").addEventListener("click", (e)=>{
      e.stopPropagation();
      div.classList.toggle("cursada");
      if(div.classList.contains("cursada")){
        if(!cursadas.includes(m.id)) cursadas.push(m.id);
      } else {
        cursadas = cursadas.filter(id=>id!==m.id);
      }
      localStorage.setItem("cursadas", JSON.stringify(cursadas));
      actualizarDisponibilidad();
    });
    document.getElementById(`sem-${num}`).appendChild(div);
  });
});

// Modal temario
const modal = document.getElementById("modal");
const modalTitulo = document.getElementById("modal-titulo");
const modalLista = document.getElementById("modal-lista");
document.querySelector(".close").onclick = ()=>modal.style.display="none";

function mostrarTemario(materia){
  modalTitulo.textContent = materia.nombre;
  modalLista.innerHTML = "";
  materia.temario.forEach(t=>{
    const li = document.createElement("li");
    li.textContent=t;
    modalLista.appendChild(li);
  });
  modal.style.display="flex";
}

// Actualizar disponibilidad
function actualizarDisponibilidad(){
  materias.forEach(m=>{
    const div=document.querySelector(`.materia[data-id="${m.id}"]`);
    if(div.classList.contains("cursada")) {
      div.classList.remove("bloqueada","disponible");
      return;
    }
    const depsOk=m.deps.every(dep=>{
      const depDiv=document.querySelector(`.materia[data-id="${dep}"]`);
      return depDiv && depDiv.classList.contains("cursada");
    });
    if(depsOk) {
      div.classList.add("disponible");
      div.classList.remove("bloqueada");
    } else {
      div.classList.add("bloqueada");
      div.classList.remove("disponible");
    }
  });
}

// Inicializar
actualizarDisponibilidad();
</script>
</body>
</html>
